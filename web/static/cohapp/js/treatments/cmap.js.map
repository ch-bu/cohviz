{"version":3,"sources":["cmap.js"],"names":["app","CmapView","Backbone","View","extend","el","events","click #instruction-read","click #help","click #editor-button","click #editor-full-button","initialize","self","this","prePageDurationStart","postPageDurationStart","colors","d3","scaleOrdinal","schemeCategory10","simulations","userModel","UserSpecificModel","textModel","TextModelComplete","analyzer","TextAnalyzerModel","fetch","success","model","response","renderInstruction","error","console","log","$el","html","Handlebars","templates","instruction","get","renderEditor","Date","editor","MediumEditor","toolbar","placeholder","$","editableElement","document","querySelector","firstChild","selectElement","append","renderInstructionModal","openModal","analyzeText","regExText","text","getParagraphs","find","length","Materialize","toast","draftElapsed","set","pre_page_duration","pre_text","save","renderRevision","responseText","pre_num_sentences","pre_num_clusters","pre_num_coherent_sentences","pre_num_non_coherent_sentences","pre_num_concepts","pre_local_cohesion","paragraphs","constants","simpleRevisionModal","svgWidth","width","svgHeight","height","renderCmap","pairs","clust","numClusters","svgID","runSimulation","currentCluster","clusterIndex","mouseover","mouseOverObject","nodeSelected","mouse","g","select","id","nodeData","data","style","svg","selectAll","d","isConnected","source","target","a","b","isConnectedAsTarget","isConnectedAsSource","index","linkedByIndex","zoomed","attr","event","transform","cluster","graph","getLinksNodes","simulation","forceSimulation","nodes","force","forceManyBody","strength","forceLink","links","distance","forceCenter","forceX","forceY","stop","call","zoom","scaleExtent","on","loading","timeout","remove","i","n","Math","ceil","alphaMin","alphaDecay","tick","link","enter","x","y","each","node","mouseout","paragraph","textParagraph","spanText","replace","jquerySpan","clusters","saveText","revisionElapsed","post_text","post_page_duration","sendToServer","post_num_sentences","post_num_clusters","post_num_coherent_sentences","post_num_non_coherent_sentences","post_num_concepts","post_local_cohesion","location","reload"],"mappings":"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","file":"cmap.js","sourcesContent":["var app = app || {};\n\n\napp.CmapView = Backbone.View.extend({\n\n    el: '#treatment-cmap',\n\n\tevents: {\n    'click #instruction-read': 'renderEditor',\n\t\t'click #help': 'renderInstructionModal',\n\t\t'click #editor-button': 'analyzeText',\n\t\t'click #editor-full-button': 'saveText',\n\t},\n\n\tinitialize: function() {\n    // Variable declaration\n    var self = this;\n    this.prePageDurationStart = null;\n    this.postPageDurationStart = null;\n\n\t\t// Generate 20 distinct colors for the cmap\n\t\tthis.colors = d3.scaleOrdinal(d3.schemeCategory10);\n\n    // this simulations\n    this.simulations = {};\n\n    // Get user data\n    this.userModel = new app.UserSpecificModel();\n\n    // Init textanalyzer model\n    this.textModel = new app.TextModelComplete();\n\n    // Init textAnalyzer model\n    this.analyzer = new app.TextAnalyzerModel();\n\n    // Fetch user data\n    this.userModel.fetch({\n        success: function(model, response) {\n            self.renderInstruction();\n        },\n        error: function(model, response) {\n            console.log(response);\n        }\n    });\n\n\t},\n\n    /** Render instruction for\n      * this part of the experiment\n      */\n\trenderInstruction: function() {\n        // Render instruction\n        this.$el.html(\n            Handlebars.templates.instruction({'instruction':\n                this.userModel.get('instruction')}));\n\t},\n\n\t/**\n     * When user has read the instruction he or she is able\n     * to write their text.\n     */\n    renderEditor: function() {\n        // Start timer for draft\n        this.prePageDurationStart = new Date();\n\n        // Render editor\n        this.$el.html(Handlebars.templates.editor());\n\n        // Enable editor functionality\n        var editor = new MediumEditor('#editor-textinput', {\n            toolbar: false,\n            placeholder: false,\n        });\n\n        // Add text to editor\n        $('#editor-textinput').html('<p>Schreibe hier ...</p>');\n\n        // Select text so that user can type instantly\n        var editableElement = document.\n            querySelector('#editor-textinput').firstChild;\n        editor.selectElement(editableElement);\n\n        // Append help button to window\n        this.$el.append('<i id=\"help\" class=\"material-icons\">help</i>');\n\n        // Append modal\n        this.$el.append(Handlebars.templates['modal-help']({'instruction':\n            this.userModel.get('instruction') }));\n    },\n\n    /**\n     * Render modal of instruction\n     */\n    renderInstructionModal: function() {\n        $('#modal-help').openModal();\n    },\n\n    /**\n     * After user has written his or her text the\n     * user gets feedback on the draft.\n     * Before users can see the feedback we need\n     * to make some sanity checks whether the\n     * text is long enough.\n     */\n    analyzeText: function() {\n        var self = this;\n\n        // Change text with major concepts\n        app.regExText('#editor-textinput');\n\n        // Get text\n        var text = app.getParagraphs(this.$el.find('#editor-textinput'));\n\n        // Check if text is long enough\n        if (text.length < 1000) {\n            // Display toast\n            Materialize.toast('Ihr Text ist leider zu kurz.', 4000);\n        } else {\n            // Stop timer for draft\n            var draftElapsed = (new Date() - this.prePageDurationStart) / 1000;\n\n            // Start timer for text revision\n            this.postPageDurationStart = new Date();\n\n            // Set draft time and draftText to textModel\n            this.textModel.set({'pre_page_duration': draftElapsed,\n                                'pre_text': text});\n\n            // Render loading ring\n            this.$el.find('#editor-button-div').html(\n                Handlebars.templates['loading-ring']());\n\n            // Get text data\n            this.analyzer.set({'text': text});\n            this.analyzer.save(null, {\n                success: function(response) {\n                    self.renderRevision();\n                },\n                error: function(model, response) {\n                    console.log(response.responseText);\n                }\n            });\n        }\n    },\n\n\n    /**\n     * After user has written the draft she gets the\n     * opportunity to revise her text\n     */\n    renderRevision: function() {\n      var self = this;\n\n      // Render submit button\n      this.$el.find('#editor-button-div').html(\n              '<a class=\"waves-effect waves-light btn\" id=\"save-text\">Text abschicken</a>');\n\n      // Save data for draft\n      this.textModel.set({'pre_text': this.analyzer.get('text'),\n          'pre_num_sentences': this.analyzer.get('numSentences'),\n          'pre_num_clusters': this.analyzer.get('numCluster'),\n          'pre_num_coherent_sentences': this.analyzer.get('cohSentences'),\n          'pre_num_non_coherent_sentences': this.analyzer.get('cohNotSentences'),\n          'pre_num_concepts': this.analyzer.get('numConcepts'),\n          'pre_local_cohesion': this.analyzer.get('local cohesion')});\n\n      // Get inner html of text input\n      this.paragraphs = $('#editor-textinput').html();\n\n          // Change inner html\n          this.$el.html(Handlebars.templates['editor-full']({'instruction':\n              app.constants.simpleRevisionModal}));\n\n          // Append help button to window\n          this.$el.append('<i id=\"help\" class=\"material-icons\">help</i>');\n\n          // Append modal\n          this.$el.append(Handlebars.templates['modal-help']({'instruction':\n              this.userModel.get('instructionreview') }));\n\n          // Change inner html of editor\n          $('#editor-full-medium-editor').html(this.paragraphs);\n\n          // Enable editor functionality\n          var editor = new MediumEditor('#editor-full-medium-editor', {\n        toolbar: false,\n      });\n\n      // Change text of Button\n      $('#editor-full-button').text('Text abschicken');\n\n      // Display modal\n      this.$el.append(Handlebars.templates['modal-revision']({'instruction':\n          this.userModel.get('instructionreview')}));\n      $('#modal-revision').openModal();\n\n      // Set width of height of svg element\n      var svgWidth = $('#editor-full-graph').width();\n      var svgHeight = $('#editor-full-medium-editor').height();\n\n      // Render graph\n      this.renderCmap(this.analyzer.get('word_pairs'),\n        this.analyzer.get('clusters'), this.analyzer.get('numClusters'),\n        '#editor-full-graph', svgHeight, svgWidth, this.colors);\n      },\n\n\n\trenderCmap: function(pairs, clust, numClusters, svgID, height, width, colors)  {\n    var self = this;\n    var svgHeight = height / 2;\n    var svgWidth = width / 2;\n    var margin = {top: 0, right: 0, bottom: 0, left: 0};\n\n    /**\n     * Closure\n     * @param  {[type]} currentCluster [description]\n     * @return {[type]}                [description]\n     */\n    function runSimulation(currentCluster, clusterIndex) {\n      // Save temporary cluster\n      var cluster = currentCluster;\n\n      // Get data for force simulation with\n      // nodes and links\n      var graph = app.getLinksNodes(cluster);\n\n      // Create svg\n      var svg = d3.select(svgID).append(\"svg\");\n        // .attr(\"width\", svgWidth + margin.left + margin.right)\n        // .attr(\"height\", svgHeight + margin.top + margin.bottom);\n\n      // Create force simulation\n      var simulation = d3.forceSimulation(graph.nodes)\n        .force('charge', d3.forceManyBody().strength(-240))\n        .force('link', d3.forceLink(graph.links)\n          .distance(200)\n          .id(function(d) {\n            return d.id;\n          }))\n        // .force(\"collide\", d3.forceCollide().radius(function(d) { return d.r + 1.5; }).iterations(2))\n        .force('center', d3.forceCenter(svgWidth / 2, svgHeight / 2))\n        .force('x', d3.forceX())\n        .force('y', d3.forceY())\n        .stop();\n\n      // Wrap everything in g element\n      var g = svg.append('g');\n\n      // Stores all links\n      var linkedByIndex = {};\n\n      // Call zoom\n      svg.call(d3.zoom()\n        .scaleExtent([1 / 10, 10])\n        .on('zoom', zoomed));\n\n      var loading = svg.append(\"text\")\n        .attr(\"dy\", \"0.35em\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"font-family\", \"sans-serif\")\n        .attr(\"font-size\", 10)\n        .attr('x', svgWidth / 2)\n        .attr('y', svgHeight / 2)\n        .text(\"Simulating. One moment pleaseâ€¦\");\n\n      // Run simulation in the background\n      d3.timeout(function() {\n        loading.remove();\n\n        // See https://github.com/d3/d3-force/blob/master/README.md#simulation_tick\n        for (var i = 0, n = Math.ceil(Math.log(simulation.alphaMin()) / Math.log(1 - simulation.alphaDecay())); i < n; ++i) {\n          simulation.tick();\n        }\n\n        // Add links\n        var link = g.append('g')\n          .attr('class', 'links')\n          .selectAll('line')\n          .data(graph.links)\n          .enter().append('line')\n          .attr(\"x1\", function(d) { return d.source.x; })\n          .attr(\"y1\", function(d) { return d.source.y; })\n          .attr(\"x2\", function(d) { return d.target.x; })\n          .attr(\"y2\", function(d) { return d.target.y; });\n\n        link.each(function(d) {\n          linkedByIndex[d.source.index + \",\" + d.target.index] = true;\n        });\n\n        // Add data of simulation globally\n        self.simulations[clusterIndex] = {'simulation': simulation, 'linkedByIndex': linkedByIndex, 'svg': svg};\n\n        // Create g element that stores\n        // circles and text and call dragging on it\n        var node = g.append('g')\n          .attr('class', 'nodes')\n          .selectAll('.node')\n          .data(graph.nodes)\n          .enter().append('g')\n          .attr('id', function(d, i) {\n            return 'node-' + d.id;\n          })\n          .attr('class', 'node')\n          .attr('transform', function(d) {\n            return 'translate(' + d.x + ',' + d.y + ')';\n          })\n          .on('mouseover', mouseover)\n          .on('mouseout', mouseout);\n\n        // Append circle\n        var circle = node.append('circle')\n          .attr('r', 10)\n          .attr('cx', 0)\n          .attr('cy', 0)\n          .attr('fill', '#ccc');\n\n        // Append label to node container\n        var label = node.append('text')\n          .attr('dy', -10)\n          .attr('dx', 12)\n          .style('opacity', 0.8)\n          .attr('text-anchor', 'start')\n          .text(function(d) {\n            return d.id;\n          });\n      });\n\n      function mouseover(mouseOverObject) {\n        // Get data\n        var mouse = d3.mouse(this);\n\n        // Select element that is hovered\n        var nodeSelected = g.select('#node-' + mouseOverObject.id);\n        var nodeData = nodeSelected.data()[0];\n\n        // Change text of selected element\n        var textSelected = nodeSelected.select('text')\n          .style('opacity', 1)\n          .style('font-weight', 'bold');\n\n        // Highlight adjacent nodes\n        svg.selectAll('text')\n          .style('opacity', function(d) {\n           if (isConnected(nodeData, d)) {\n             return 1;\n           }\n\n           return 0.1;\n\n          });\n\n        svg.selectAll('circle')\n          .style('fill', function(d) {\n            if (isConnected(nodeData, d)) {\n              return '#000';\n            }\n\n            return '#f4f4f4';\n          })\n          .style('opacity', function(d) {\n            if (isConnected(nodeData, d)) {\n              return 1;\n            }\n\n            return 0.2;\n          });\n\n        /////////////////////\n        // Highlight links //\n        /////////////////////\n        svg.selectAll('line')\n          .style('stroke', function(d) {\n            return d.source.id === nodeData.id || d.target.id === nodeData.id ? '#4c4c4c' : '#f4f4f4';\n          });\n      }\n\n      function isConnected(a, b) {\n        return isConnectedAsTarget(a, b) || isConnectedAsSource(a, b) || a.index == b.index;\n      }\n\n      function isConnectedAsSource(a, b) {\n        return linkedByIndex[a.index + \",\" + b.index];\n      }\n\n      function isConnectedAsTarget(a, b) {\n        return linkedByIndex[b.index + \",\" + a.index];\n      }\n\n      function zoomed() {\n        g.attr('transform', d3.event.transform);\n      }\n    }\n\n    // Store clusters temporarily\n    var clusters = this.analyzer.get('clusters');\n\n    // Create svg for each cluster\n    for (var i = 0; i < clusters.length; i++) {\n      runSimulation(clusters[i], i);\n    }\n\n    function mouseout() {\n      $('#editor-full-medium-editor').find('p').each(function(paragraph) {\n        var textParagraph = $(this).text();\n        // Wrap everything in span elements\n        var spanText = textParagraph.replace(/([A-z0-9'<>\\u00dc\\u00fc\\u00e4\\u00c4\\u00f6\\u00d6\\u00df\\-/]+)/g, '<span>$1</span>');\n\n        var jquerySpan = $(spanText);\n\n        // Generate spans for text\n        $(this).html(jquerySpan);\n      });\n\n      // Get all nodes\n      var nodes = d3.selectAll('.node');\n\n      nodes.selectAll('text')\n         .style('opacity', 0.8)\n         .style('font-weight', 'normal');\n\n      d3.selectAll('circle')\n        .style('fill', '#ccc')\n        .style('opacity', 1);\n\n      d3.selectAll('.links').selectAll('line')\n       .style('stroke', '#ccc');\n    }\n  },\n\n  saveText: function() {\n      var self = this;\n\n      // Get seconds subject worked for revision\n      var revisionElapsed = (new Date() - this.postPageDurationStart) / 1000;\n\n      // Render loading ring\n      this.$el.find('#editor-full-button-div').html(\n          Handlebars.templates['loading-ring']());\n\n      // Get text\n      var text = app.getParagraphs(this.$el.find('#editor-full-medium-editor'));\n\n      // Save post text to textModel\n      this.textModel.set({'post_text': text,\n                          'post_page_duration': revisionElapsed});\n\n      // Set text to analyzer\n      this.analyzer.set({'text': text});\n\n      // Fetch data\n      this.analyzer.save(null, {\n          success: function(response) {\n              self.sendToServer();\n          },\n          error: function(model, response) {\n              console.log(response.responseText);\n          }\n      });\n  },\n\n  sendToServer: function() {\n    // Save last data\n    this.textModel.set({'post_num_sentences': this.analyzer.get('numSentences'),\n        'post_num_clusters': this.analyzer.get('numCluster'),\n        'post_num_coherent_sentences': this.analyzer.get('cohSentences'),\n        'post_num_non_coherent_sentences': this.analyzer.get('cohNotSentences'),\n        'post_num_concepts': this.analyzer.get('numConcepts'),\n        'post_local_cohesion': this.analyzer.get('local cohesion')});\n\n    // Send data to server\n    this.textModel.save(null, {\n        success: function(response) {\n            // Reload page\n            location.reload();\n        },\n        error: function(model, response) {\n            console.log('error');\n        }\n    });\n  }\n});\n\nnew app.CmapView();\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJjbWFwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhcHAgfHwge307XG5cblxuYXBwLkNtYXBWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXG4gICAgZWw6ICcjdHJlYXRtZW50LWNtYXAnLFxuXG5cdGV2ZW50czoge1xuICAgICdjbGljayAjaW5zdHJ1Y3Rpb24tcmVhZCc6ICdyZW5kZXJFZGl0b3InLFxuXHRcdCdjbGljayAjaGVscCc6ICdyZW5kZXJJbnN0cnVjdGlvbk1vZGFsJyxcblx0XHQnY2xpY2sgI2VkaXRvci1idXR0b24nOiAnYW5hbHl6ZVRleHQnLFxuXHRcdCdjbGljayAjZWRpdG9yLWZ1bGwtYnV0dG9uJzogJ3NhdmVUZXh0Jyxcblx0fSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAvLyBWYXJpYWJsZSBkZWNsYXJhdGlvblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLnByZVBhZ2VEdXJhdGlvblN0YXJ0ID0gbnVsbDtcbiAgICB0aGlzLnBvc3RQYWdlRHVyYXRpb25TdGFydCA9IG51bGw7XG5cblx0XHQvLyBHZW5lcmF0ZSAyMCBkaXN0aW5jdCBjb2xvcnMgZm9yIHRoZSBjbWFwXG5cdFx0dGhpcy5jb2xvcnMgPSBkMy5zY2FsZU9yZGluYWwoZDMuc2NoZW1lQ2F0ZWdvcnkxMCk7XG5cbiAgICAvLyB0aGlzIHNpbXVsYXRpb25zXG4gICAgdGhpcy5zaW11bGF0aW9ucyA9IHt9O1xuXG4gICAgLy8gR2V0IHVzZXIgZGF0YVxuICAgIHRoaXMudXNlck1vZGVsID0gbmV3IGFwcC5Vc2VyU3BlY2lmaWNNb2RlbCgpO1xuXG4gICAgLy8gSW5pdCB0ZXh0YW5hbHl6ZXIgbW9kZWxcbiAgICB0aGlzLnRleHRNb2RlbCA9IG5ldyBhcHAuVGV4dE1vZGVsQ29tcGxldGUoKTtcblxuICAgIC8vIEluaXQgdGV4dEFuYWx5emVyIG1vZGVsXG4gICAgdGhpcy5hbmFseXplciA9IG5ldyBhcHAuVGV4dEFuYWx5emVyTW9kZWwoKTtcblxuICAgIC8vIEZldGNoIHVzZXIgZGF0YVxuICAgIHRoaXMudXNlck1vZGVsLmZldGNoKHtcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24obW9kZWwsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBzZWxmLnJlbmRlckluc3RydWN0aW9uKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbihtb2RlbCwgcmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cdH0sXG5cbiAgICAvKiogUmVuZGVyIGluc3RydWN0aW9uIGZvclxuICAgICAgKiB0aGlzIHBhcnQgb2YgdGhlIGV4cGVyaW1lbnRcbiAgICAgICovXG5cdHJlbmRlckluc3RydWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gUmVuZGVyIGluc3RydWN0aW9uXG4gICAgICAgIHRoaXMuJGVsLmh0bWwoXG4gICAgICAgICAgICBIYW5kbGViYXJzLnRlbXBsYXRlcy5pbnN0cnVjdGlvbih7J2luc3RydWN0aW9uJzpcbiAgICAgICAgICAgICAgICB0aGlzLnVzZXJNb2RlbC5nZXQoJ2luc3RydWN0aW9uJyl9KSk7XG5cdH0sXG5cblx0LyoqXG4gICAgICogV2hlbiB1c2VyIGhhcyByZWFkIHRoZSBpbnN0cnVjdGlvbiBoZSBvciBzaGUgaXMgYWJsZVxuICAgICAqIHRvIHdyaXRlIHRoZWlyIHRleHQuXG4gICAgICovXG4gICAgcmVuZGVyRWRpdG9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gU3RhcnQgdGltZXIgZm9yIGRyYWZ0XG4gICAgICAgIHRoaXMucHJlUGFnZUR1cmF0aW9uU3RhcnQgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgIC8vIFJlbmRlciBlZGl0b3JcbiAgICAgICAgdGhpcy4kZWwuaHRtbChIYW5kbGViYXJzLnRlbXBsYXRlcy5lZGl0b3IoKSk7XG5cbiAgICAgICAgLy8gRW5hYmxlIGVkaXRvciBmdW5jdGlvbmFsaXR5XG4gICAgICAgIHZhciBlZGl0b3IgPSBuZXcgTWVkaXVtRWRpdG9yKCcjZWRpdG9yLXRleHRpbnB1dCcsIHtcbiAgICAgICAgICAgIHRvb2xiYXI6IGZhbHNlLFxuICAgICAgICAgICAgcGxhY2Vob2xkZXI6IGZhbHNlLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgdGV4dCB0byBlZGl0b3JcbiAgICAgICAgJCgnI2VkaXRvci10ZXh0aW5wdXQnKS5odG1sKCc8cD5TY2hyZWliZSBoaWVyIC4uLjwvcD4nKTtcblxuICAgICAgICAvLyBTZWxlY3QgdGV4dCBzbyB0aGF0IHVzZXIgY2FuIHR5cGUgaW5zdGFudGx5XG4gICAgICAgIHZhciBlZGl0YWJsZUVsZW1lbnQgPSBkb2N1bWVudC5cbiAgICAgICAgICAgIHF1ZXJ5U2VsZWN0b3IoJyNlZGl0b3ItdGV4dGlucHV0JykuZmlyc3RDaGlsZDtcbiAgICAgICAgZWRpdG9yLnNlbGVjdEVsZW1lbnQoZWRpdGFibGVFbGVtZW50KTtcblxuICAgICAgICAvLyBBcHBlbmQgaGVscCBidXR0b24gdG8gd2luZG93XG4gICAgICAgIHRoaXMuJGVsLmFwcGVuZCgnPGkgaWQ9XCJoZWxwXCIgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmhlbHA8L2k+Jyk7XG5cbiAgICAgICAgLy8gQXBwZW5kIG1vZGFsXG4gICAgICAgIHRoaXMuJGVsLmFwcGVuZChIYW5kbGViYXJzLnRlbXBsYXRlc1snbW9kYWwtaGVscCddKHsnaW5zdHJ1Y3Rpb24nOlxuICAgICAgICAgICAgdGhpcy51c2VyTW9kZWwuZ2V0KCdpbnN0cnVjdGlvbicpIH0pKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIG1vZGFsIG9mIGluc3RydWN0aW9uXG4gICAgICovXG4gICAgcmVuZGVySW5zdHJ1Y3Rpb25Nb2RhbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICQoJyNtb2RhbC1oZWxwJykub3Blbk1vZGFsKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEFmdGVyIHVzZXIgaGFzIHdyaXR0ZW4gaGlzIG9yIGhlciB0ZXh0IHRoZVxuICAgICAqIHVzZXIgZ2V0cyBmZWVkYmFjayBvbiB0aGUgZHJhZnQuXG4gICAgICogQmVmb3JlIHVzZXJzIGNhbiBzZWUgdGhlIGZlZWRiYWNrIHdlIG5lZWRcbiAgICAgKiB0byBtYWtlIHNvbWUgc2FuaXR5IGNoZWNrcyB3aGV0aGVyIHRoZVxuICAgICAqIHRleHQgaXMgbG9uZyBlbm91Z2guXG4gICAgICovXG4gICAgYW5hbHl6ZVRleHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgLy8gQ2hhbmdlIHRleHQgd2l0aCBtYWpvciBjb25jZXB0c1xuICAgICAgICBhcHAucmVnRXhUZXh0KCcjZWRpdG9yLXRleHRpbnB1dCcpO1xuXG4gICAgICAgIC8vIEdldCB0ZXh0XG4gICAgICAgIHZhciB0ZXh0ID0gYXBwLmdldFBhcmFncmFwaHModGhpcy4kZWwuZmluZCgnI2VkaXRvci10ZXh0aW5wdXQnKSk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGV4dCBpcyBsb25nIGVub3VnaFxuICAgICAgICBpZiAodGV4dC5sZW5ndGggPCAxMDAwKSB7XG4gICAgICAgICAgICAvLyBEaXNwbGF5IHRvYXN0XG4gICAgICAgICAgICBNYXRlcmlhbGl6ZS50b2FzdCgnSWhyIFRleHQgaXN0IGxlaWRlciB6dSBrdXJ6LicsIDQwMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gU3RvcCB0aW1lciBmb3IgZHJhZnRcbiAgICAgICAgICAgIHZhciBkcmFmdEVsYXBzZWQgPSAobmV3IERhdGUoKSAtIHRoaXMucHJlUGFnZUR1cmF0aW9uU3RhcnQpIC8gMTAwMDtcblxuICAgICAgICAgICAgLy8gU3RhcnQgdGltZXIgZm9yIHRleHQgcmV2aXNpb25cbiAgICAgICAgICAgIHRoaXMucG9zdFBhZ2VEdXJhdGlvblN0YXJ0ID0gbmV3IERhdGUoKTtcblxuICAgICAgICAgICAgLy8gU2V0IGRyYWZ0IHRpbWUgYW5kIGRyYWZ0VGV4dCB0byB0ZXh0TW9kZWxcbiAgICAgICAgICAgIHRoaXMudGV4dE1vZGVsLnNldCh7J3ByZV9wYWdlX2R1cmF0aW9uJzogZHJhZnRFbGFwc2VkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncHJlX3RleHQnOiB0ZXh0fSk7XG5cbiAgICAgICAgICAgIC8vIFJlbmRlciBsb2FkaW5nIHJpbmdcbiAgICAgICAgICAgIHRoaXMuJGVsLmZpbmQoJyNlZGl0b3ItYnV0dG9uLWRpdicpLmh0bWwoXG4gICAgICAgICAgICAgICAgSGFuZGxlYmFycy50ZW1wbGF0ZXNbJ2xvYWRpbmctcmluZyddKCkpO1xuXG4gICAgICAgICAgICAvLyBHZXQgdGV4dCBkYXRhXG4gICAgICAgICAgICB0aGlzLmFuYWx5emVyLnNldCh7J3RleHQnOiB0ZXh0fSk7XG4gICAgICAgICAgICB0aGlzLmFuYWx5emVyLnNhdmUobnVsbCwge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucmVuZGVyUmV2aXNpb24oKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihtb2RlbCwgcmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sXG5cblxuICAgIC8qKlxuICAgICAqIEFmdGVyIHVzZXIgaGFzIHdyaXR0ZW4gdGhlIGRyYWZ0IHNoZSBnZXRzIHRoZVxuICAgICAqIG9wcG9ydHVuaXR5IHRvIHJldmlzZSBoZXIgdGV4dFxuICAgICAqL1xuICAgIHJlbmRlclJldmlzaW9uOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgLy8gUmVuZGVyIHN1Ym1pdCBidXR0b25cbiAgICAgIHRoaXMuJGVsLmZpbmQoJyNlZGl0b3ItYnV0dG9uLWRpdicpLmh0bWwoXG4gICAgICAgICAgICAgICc8YSBjbGFzcz1cIndhdmVzLWVmZmVjdCB3YXZlcy1saWdodCBidG5cIiBpZD1cInNhdmUtdGV4dFwiPlRleHQgYWJzY2hpY2tlbjwvYT4nKTtcblxuICAgICAgLy8gU2F2ZSBkYXRhIGZvciBkcmFmdFxuICAgICAgdGhpcy50ZXh0TW9kZWwuc2V0KHsncHJlX3RleHQnOiB0aGlzLmFuYWx5emVyLmdldCgndGV4dCcpLFxuICAgICAgICAgICdwcmVfbnVtX3NlbnRlbmNlcyc6IHRoaXMuYW5hbHl6ZXIuZ2V0KCdudW1TZW50ZW5jZXMnKSxcbiAgICAgICAgICAncHJlX251bV9jbHVzdGVycyc6IHRoaXMuYW5hbHl6ZXIuZ2V0KCdudW1DbHVzdGVyJyksXG4gICAgICAgICAgJ3ByZV9udW1fY29oZXJlbnRfc2VudGVuY2VzJzogdGhpcy5hbmFseXplci5nZXQoJ2NvaFNlbnRlbmNlcycpLFxuICAgICAgICAgICdwcmVfbnVtX25vbl9jb2hlcmVudF9zZW50ZW5jZXMnOiB0aGlzLmFuYWx5emVyLmdldCgnY29oTm90U2VudGVuY2VzJyksXG4gICAgICAgICAgJ3ByZV9udW1fY29uY2VwdHMnOiB0aGlzLmFuYWx5emVyLmdldCgnbnVtQ29uY2VwdHMnKSxcbiAgICAgICAgICAncHJlX2xvY2FsX2NvaGVzaW9uJzogdGhpcy5hbmFseXplci5nZXQoJ2xvY2FsIGNvaGVzaW9uJyl9KTtcblxuICAgICAgLy8gR2V0IGlubmVyIGh0bWwgb2YgdGV4dCBpbnB1dFxuICAgICAgdGhpcy5wYXJhZ3JhcGhzID0gJCgnI2VkaXRvci10ZXh0aW5wdXQnKS5odG1sKCk7XG5cbiAgICAgICAgICAvLyBDaGFuZ2UgaW5uZXIgaHRtbFxuICAgICAgICAgIHRoaXMuJGVsLmh0bWwoSGFuZGxlYmFycy50ZW1wbGF0ZXNbJ2VkaXRvci1mdWxsJ10oeydpbnN0cnVjdGlvbic6XG4gICAgICAgICAgICAgIGFwcC5jb25zdGFudHMuc2ltcGxlUmV2aXNpb25Nb2RhbH0pKTtcblxuICAgICAgICAgIC8vIEFwcGVuZCBoZWxwIGJ1dHRvbiB0byB3aW5kb3dcbiAgICAgICAgICB0aGlzLiRlbC5hcHBlbmQoJzxpIGlkPVwiaGVscFwiIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5oZWxwPC9pPicpO1xuXG4gICAgICAgICAgLy8gQXBwZW5kIG1vZGFsXG4gICAgICAgICAgdGhpcy4kZWwuYXBwZW5kKEhhbmRsZWJhcnMudGVtcGxhdGVzWydtb2RhbC1oZWxwJ10oeydpbnN0cnVjdGlvbic6XG4gICAgICAgICAgICAgIHRoaXMudXNlck1vZGVsLmdldCgnaW5zdHJ1Y3Rpb25yZXZpZXcnKSB9KSk7XG5cbiAgICAgICAgICAvLyBDaGFuZ2UgaW5uZXIgaHRtbCBvZiBlZGl0b3JcbiAgICAgICAgICAkKCcjZWRpdG9yLWZ1bGwtbWVkaXVtLWVkaXRvcicpLmh0bWwodGhpcy5wYXJhZ3JhcGhzKTtcblxuICAgICAgICAgIC8vIEVuYWJsZSBlZGl0b3IgZnVuY3Rpb25hbGl0eVxuICAgICAgICAgIHZhciBlZGl0b3IgPSBuZXcgTWVkaXVtRWRpdG9yKCcjZWRpdG9yLWZ1bGwtbWVkaXVtLWVkaXRvcicsIHtcbiAgICAgICAgdG9vbGJhcjogZmFsc2UsXG4gICAgICB9KTtcblxuICAgICAgLy8gQ2hhbmdlIHRleHQgb2YgQnV0dG9uXG4gICAgICAkKCcjZWRpdG9yLWZ1bGwtYnV0dG9uJykudGV4dCgnVGV4dCBhYnNjaGlja2VuJyk7XG5cbiAgICAgIC8vIERpc3BsYXkgbW9kYWxcbiAgICAgIHRoaXMuJGVsLmFwcGVuZChIYW5kbGViYXJzLnRlbXBsYXRlc1snbW9kYWwtcmV2aXNpb24nXSh7J2luc3RydWN0aW9uJzpcbiAgICAgICAgICB0aGlzLnVzZXJNb2RlbC5nZXQoJ2luc3RydWN0aW9ucmV2aWV3Jyl9KSk7XG4gICAgICAkKCcjbW9kYWwtcmV2aXNpb24nKS5vcGVuTW9kYWwoKTtcblxuICAgICAgLy8gU2V0IHdpZHRoIG9mIGhlaWdodCBvZiBzdmcgZWxlbWVudFxuICAgICAgdmFyIHN2Z1dpZHRoID0gJCgnI2VkaXRvci1mdWxsLWdyYXBoJykud2lkdGgoKTtcbiAgICAgIHZhciBzdmdIZWlnaHQgPSAkKCcjZWRpdG9yLWZ1bGwtbWVkaXVtLWVkaXRvcicpLmhlaWdodCgpO1xuXG4gICAgICAvLyBSZW5kZXIgZ3JhcGhcbiAgICAgIHRoaXMucmVuZGVyQ21hcCh0aGlzLmFuYWx5emVyLmdldCgnd29yZF9wYWlycycpLFxuICAgICAgICB0aGlzLmFuYWx5emVyLmdldCgnY2x1c3RlcnMnKSwgdGhpcy5hbmFseXplci5nZXQoJ251bUNsdXN0ZXJzJyksXG4gICAgICAgICcjZWRpdG9yLWZ1bGwtZ3JhcGgnLCBzdmdIZWlnaHQsIHN2Z1dpZHRoLCB0aGlzLmNvbG9ycyk7XG4gICAgICB9LFxuXG5cblx0cmVuZGVyQ21hcDogZnVuY3Rpb24ocGFpcnMsIGNsdXN0LCBudW1DbHVzdGVycywgc3ZnSUQsIGhlaWdodCwgd2lkdGgsIGNvbG9ycykgIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHN2Z0hlaWdodCA9IGhlaWdodCAvIDI7XG4gICAgdmFyIHN2Z1dpZHRoID0gd2lkdGggLyAyO1xuICAgIHZhciBtYXJnaW4gPSB7dG9wOiAwLCByaWdodDogMCwgYm90dG9tOiAwLCBsZWZ0OiAwfTtcblxuICAgIC8qKlxuICAgICAqIENsb3N1cmVcbiAgICAgKiBAcGFyYW0gIHtbdHlwZV19IGN1cnJlbnRDbHVzdGVyIFtkZXNjcmlwdGlvbl1cbiAgICAgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgICAgICAgICAgIFtkZXNjcmlwdGlvbl1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBydW5TaW11bGF0aW9uKGN1cnJlbnRDbHVzdGVyLCBjbHVzdGVySW5kZXgpIHtcbiAgICAgIC8vIFNhdmUgdGVtcG9yYXJ5IGNsdXN0ZXJcbiAgICAgIHZhciBjbHVzdGVyID0gY3VycmVudENsdXN0ZXI7XG5cbiAgICAgIC8vIEdldCBkYXRhIGZvciBmb3JjZSBzaW11bGF0aW9uIHdpdGhcbiAgICAgIC8vIG5vZGVzIGFuZCBsaW5rc1xuICAgICAgdmFyIGdyYXBoID0gYXBwLmdldExpbmtzTm9kZXMoY2x1c3Rlcik7XG5cbiAgICAgIC8vIENyZWF0ZSBzdmdcbiAgICAgIHZhciBzdmcgPSBkMy5zZWxlY3Qoc3ZnSUQpLmFwcGVuZChcInN2Z1wiKTtcbiAgICAgICAgLy8gLmF0dHIoXCJ3aWR0aFwiLCBzdmdXaWR0aCArIG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0KVxuICAgICAgICAvLyAuYXR0cihcImhlaWdodFwiLCBzdmdIZWlnaHQgKyBtYXJnaW4udG9wICsgbWFyZ2luLmJvdHRvbSk7XG5cbiAgICAgIC8vIENyZWF0ZSBmb3JjZSBzaW11bGF0aW9uXG4gICAgICB2YXIgc2ltdWxhdGlvbiA9IGQzLmZvcmNlU2ltdWxhdGlvbihncmFwaC5ub2RlcylcbiAgICAgICAgLmZvcmNlKCdjaGFyZ2UnLCBkMy5mb3JjZU1hbnlCb2R5KCkuc3RyZW5ndGgoLTI0MCkpXG4gICAgICAgIC5mb3JjZSgnbGluaycsIGQzLmZvcmNlTGluayhncmFwaC5saW5rcylcbiAgICAgICAgICAuZGlzdGFuY2UoMjAwKVxuICAgICAgICAgIC5pZChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICByZXR1cm4gZC5pZDtcbiAgICAgICAgICB9KSlcbiAgICAgICAgLy8gLmZvcmNlKFwiY29sbGlkZVwiLCBkMy5mb3JjZUNvbGxpZGUoKS5yYWRpdXMoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5yICsgMS41OyB9KS5pdGVyYXRpb25zKDIpKVxuICAgICAgICAuZm9yY2UoJ2NlbnRlcicsIGQzLmZvcmNlQ2VudGVyKHN2Z1dpZHRoIC8gMiwgc3ZnSGVpZ2h0IC8gMikpXG4gICAgICAgIC5mb3JjZSgneCcsIGQzLmZvcmNlWCgpKVxuICAgICAgICAuZm9yY2UoJ3knLCBkMy5mb3JjZVkoKSlcbiAgICAgICAgLnN0b3AoKTtcblxuICAgICAgLy8gV3JhcCBldmVyeXRoaW5nIGluIGcgZWxlbWVudFxuICAgICAgdmFyIGcgPSBzdmcuYXBwZW5kKCdnJyk7XG5cbiAgICAgIC8vIFN0b3JlcyBhbGwgbGlua3NcbiAgICAgIHZhciBsaW5rZWRCeUluZGV4ID0ge307XG5cbiAgICAgIC8vIENhbGwgem9vbVxuICAgICAgc3ZnLmNhbGwoZDMuem9vbSgpXG4gICAgICAgIC5zY2FsZUV4dGVudChbMSAvIDEwLCAxMF0pXG4gICAgICAgIC5vbignem9vbScsIHpvb21lZCkpO1xuXG4gICAgICB2YXIgbG9hZGluZyA9IHN2Zy5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgIC5hdHRyKFwiZHlcIiwgXCIwLjM1ZW1cIilcbiAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAuYXR0cihcImZvbnQtZmFtaWx5XCIsIFwic2Fucy1zZXJpZlwiKVxuICAgICAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCAxMClcbiAgICAgICAgLmF0dHIoJ3gnLCBzdmdXaWR0aCAvIDIpXG4gICAgICAgIC5hdHRyKCd5Jywgc3ZnSGVpZ2h0IC8gMilcbiAgICAgICAgLnRleHQoXCJTaW11bGF0aW5nLiBPbmUgbW9tZW50IHBsZWFzZeKAplwiKTtcblxuICAgICAgLy8gUnVuIHNpbXVsYXRpb24gaW4gdGhlIGJhY2tncm91bmRcbiAgICAgIGQzLnRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGxvYWRpbmcucmVtb3ZlKCk7XG5cbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9kMy9kMy1mb3JjZS9ibG9iL21hc3Rlci9SRUFETUUubWQjc2ltdWxhdGlvbl90aWNrXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBuID0gTWF0aC5jZWlsKE1hdGgubG9nKHNpbXVsYXRpb24uYWxwaGFNaW4oKSkgLyBNYXRoLmxvZygxIC0gc2ltdWxhdGlvbi5hbHBoYURlY2F5KCkpKTsgaSA8IG47ICsraSkge1xuICAgICAgICAgIHNpbXVsYXRpb24udGljaygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGxpbmtzXG4gICAgICAgIHZhciBsaW5rID0gZy5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdsaW5rcycpXG4gICAgICAgICAgLnNlbGVjdEFsbCgnbGluZScpXG4gICAgICAgICAgLmRhdGEoZ3JhcGgubGlua3MpXG4gICAgICAgICAgLmVudGVyKCkuYXBwZW5kKCdsaW5lJylcbiAgICAgICAgICAuYXR0cihcIngxXCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuc291cmNlLng7IH0pXG4gICAgICAgICAgLmF0dHIoXCJ5MVwiLCBmdW5jdGlvbihkKSB7IHJldHVybiBkLnNvdXJjZS55OyB9KVxuICAgICAgICAgIC5hdHRyKFwieDJcIiwgZnVuY3Rpb24oZCkgeyByZXR1cm4gZC50YXJnZXQueDsgfSlcbiAgICAgICAgICAuYXR0cihcInkyXCIsIGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudGFyZ2V0Lnk7IH0pO1xuXG4gICAgICAgIGxpbmsuZWFjaChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgbGlua2VkQnlJbmRleFtkLnNvdXJjZS5pbmRleCArIFwiLFwiICsgZC50YXJnZXQuaW5kZXhdID0gdHJ1ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWRkIGRhdGEgb2Ygc2ltdWxhdGlvbiBnbG9iYWxseVxuICAgICAgICBzZWxmLnNpbXVsYXRpb25zW2NsdXN0ZXJJbmRleF0gPSB7J3NpbXVsYXRpb24nOiBzaW11bGF0aW9uLCAnbGlua2VkQnlJbmRleCc6IGxpbmtlZEJ5SW5kZXgsICdzdmcnOiBzdmd9O1xuXG4gICAgICAgIC8vIENyZWF0ZSBnIGVsZW1lbnQgdGhhdCBzdG9yZXNcbiAgICAgICAgLy8gY2lyY2xlcyBhbmQgdGV4dCBhbmQgY2FsbCBkcmFnZ2luZyBvbiBpdFxuICAgICAgICB2YXIgbm9kZSA9IGcuYXBwZW5kKCdnJylcbiAgICAgICAgICAuYXR0cignY2xhc3MnLCAnbm9kZXMnKVxuICAgICAgICAgIC5zZWxlY3RBbGwoJy5ub2RlJylcbiAgICAgICAgICAuZGF0YShncmFwaC5ub2RlcylcbiAgICAgICAgICAuZW50ZXIoKS5hcHBlbmQoJ2cnKVxuICAgICAgICAgIC5hdHRyKCdpZCcsIGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICAgIHJldHVybiAnbm9kZS0nICsgZC5pZDtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdub2RlJylcbiAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgcmV0dXJuICd0cmFuc2xhdGUoJyArIGQueCArICcsJyArIGQueSArICcpJztcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5vbignbW91c2VvdmVyJywgbW91c2VvdmVyKVxuICAgICAgICAgIC5vbignbW91c2VvdXQnLCBtb3VzZW91dCk7XG5cbiAgICAgICAgLy8gQXBwZW5kIGNpcmNsZVxuICAgICAgICB2YXIgY2lyY2xlID0gbm9kZS5hcHBlbmQoJ2NpcmNsZScpXG4gICAgICAgICAgLmF0dHIoJ3InLCAxMClcbiAgICAgICAgICAuYXR0cignY3gnLCAwKVxuICAgICAgICAgIC5hdHRyKCdjeScsIDApXG4gICAgICAgICAgLmF0dHIoJ2ZpbGwnLCAnI2NjYycpO1xuXG4gICAgICAgIC8vIEFwcGVuZCBsYWJlbCB0byBub2RlIGNvbnRhaW5lclxuICAgICAgICB2YXIgbGFiZWwgPSBub2RlLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgLmF0dHIoJ2R5JywgLTEwKVxuICAgICAgICAgIC5hdHRyKCdkeCcsIDEyKVxuICAgICAgICAgIC5zdHlsZSgnb3BhY2l0eScsIDAuOClcbiAgICAgICAgICAuYXR0cigndGV4dC1hbmNob3InLCAnc3RhcnQnKVxuICAgICAgICAgIC50ZXh0KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgIHJldHVybiBkLmlkO1xuICAgICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIG1vdXNlb3Zlcihtb3VzZU92ZXJPYmplY3QpIHtcbiAgICAgICAgLy8gR2V0IGRhdGFcbiAgICAgICAgdmFyIG1vdXNlID0gZDMubW91c2UodGhpcyk7XG5cbiAgICAgICAgLy8gU2VsZWN0IGVsZW1lbnQgdGhhdCBpcyBob3ZlcmVkXG4gICAgICAgIHZhciBub2RlU2VsZWN0ZWQgPSBnLnNlbGVjdCgnI25vZGUtJyArIG1vdXNlT3Zlck9iamVjdC5pZCk7XG4gICAgICAgIHZhciBub2RlRGF0YSA9IG5vZGVTZWxlY3RlZC5kYXRhKClbMF07XG5cbiAgICAgICAgLy8gQ2hhbmdlIHRleHQgb2Ygc2VsZWN0ZWQgZWxlbWVudFxuICAgICAgICB2YXIgdGV4dFNlbGVjdGVkID0gbm9kZVNlbGVjdGVkLnNlbGVjdCgndGV4dCcpXG4gICAgICAgICAgLnN0eWxlKCdvcGFjaXR5JywgMSlcbiAgICAgICAgICAuc3R5bGUoJ2ZvbnQtd2VpZ2h0JywgJ2JvbGQnKTtcblxuICAgICAgICAvLyBIaWdobGlnaHQgYWRqYWNlbnQgbm9kZXNcbiAgICAgICAgc3ZnLnNlbGVjdEFsbCgndGV4dCcpXG4gICAgICAgICAgLnN0eWxlKCdvcGFjaXR5JywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICBpZiAoaXNDb25uZWN0ZWQobm9kZURhdGEsIGQpKSB7XG4gICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgIH1cblxuICAgICAgICAgICByZXR1cm4gMC4xO1xuXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgc3ZnLnNlbGVjdEFsbCgnY2lyY2xlJylcbiAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICBpZiAoaXNDb25uZWN0ZWQobm9kZURhdGEsIGQpKSB7XG4gICAgICAgICAgICAgIHJldHVybiAnIzAwMCc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAnI2Y0ZjRmNCc7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuc3R5bGUoJ29wYWNpdHknLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICBpZiAoaXNDb25uZWN0ZWQobm9kZURhdGEsIGQpKSB7XG4gICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gMC4yO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAvLyBIaWdobGlnaHQgbGlua3MgLy9cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgIHN2Zy5zZWxlY3RBbGwoJ2xpbmUnKVxuICAgICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgcmV0dXJuIGQuc291cmNlLmlkID09PSBub2RlRGF0YS5pZCB8fCBkLnRhcmdldC5pZCA9PT0gbm9kZURhdGEuaWQgPyAnIzRjNGM0YycgOiAnI2Y0ZjRmNCc7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGlzQ29ubmVjdGVkKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGlzQ29ubmVjdGVkQXNUYXJnZXQoYSwgYikgfHwgaXNDb25uZWN0ZWRBc1NvdXJjZShhLCBiKSB8fCBhLmluZGV4ID09IGIuaW5kZXg7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGlzQ29ubmVjdGVkQXNTb3VyY2UoYSwgYikge1xuICAgICAgICByZXR1cm4gbGlua2VkQnlJbmRleFthLmluZGV4ICsgXCIsXCIgKyBiLmluZGV4XTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gaXNDb25uZWN0ZWRBc1RhcmdldChhLCBiKSB7XG4gICAgICAgIHJldHVybiBsaW5rZWRCeUluZGV4W2IuaW5kZXggKyBcIixcIiArIGEuaW5kZXhdO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiB6b29tZWQoKSB7XG4gICAgICAgIGcuYXR0cigndHJhbnNmb3JtJywgZDMuZXZlbnQudHJhbnNmb3JtKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTdG9yZSBjbHVzdGVycyB0ZW1wb3JhcmlseVxuICAgIHZhciBjbHVzdGVycyA9IHRoaXMuYW5hbHl6ZXIuZ2V0KCdjbHVzdGVycycpO1xuXG4gICAgLy8gQ3JlYXRlIHN2ZyBmb3IgZWFjaCBjbHVzdGVyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbHVzdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgcnVuU2ltdWxhdGlvbihjbHVzdGVyc1tpXSwgaSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbW91c2VvdXQoKSB7XG4gICAgICAkKCcjZWRpdG9yLWZ1bGwtbWVkaXVtLWVkaXRvcicpLmZpbmQoJ3AnKS5lYWNoKGZ1bmN0aW9uKHBhcmFncmFwaCkge1xuICAgICAgICB2YXIgdGV4dFBhcmFncmFwaCA9ICQodGhpcykudGV4dCgpO1xuICAgICAgICAvLyBXcmFwIGV2ZXJ5dGhpbmcgaW4gc3BhbiBlbGVtZW50c1xuICAgICAgICB2YXIgc3BhblRleHQgPSB0ZXh0UGFyYWdyYXBoLnJlcGxhY2UoLyhbQS16MC05Jzw+XFx1MDBkY1xcdTAwZmNcXHUwMGU0XFx1MDBjNFxcdTAwZjZcXHUwMGQ2XFx1MDBkZlxcLS9dKykvZywgJzxzcGFuPiQxPC9zcGFuPicpO1xuXG4gICAgICAgIHZhciBqcXVlcnlTcGFuID0gJChzcGFuVGV4dCk7XG5cbiAgICAgICAgLy8gR2VuZXJhdGUgc3BhbnMgZm9yIHRleHRcbiAgICAgICAgJCh0aGlzKS5odG1sKGpxdWVyeVNwYW4pO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEdldCBhbGwgbm9kZXNcbiAgICAgIHZhciBub2RlcyA9IGQzLnNlbGVjdEFsbCgnLm5vZGUnKTtcblxuICAgICAgbm9kZXMuc2VsZWN0QWxsKCd0ZXh0JylcbiAgICAgICAgIC5zdHlsZSgnb3BhY2l0eScsIDAuOClcbiAgICAgICAgIC5zdHlsZSgnZm9udC13ZWlnaHQnLCAnbm9ybWFsJyk7XG5cbiAgICAgIGQzLnNlbGVjdEFsbCgnY2lyY2xlJylcbiAgICAgICAgLnN0eWxlKCdmaWxsJywgJyNjY2MnKVxuICAgICAgICAuc3R5bGUoJ29wYWNpdHknLCAxKTtcblxuICAgICAgZDMuc2VsZWN0QWxsKCcubGlua3MnKS5zZWxlY3RBbGwoJ2xpbmUnKVxuICAgICAgIC5zdHlsZSgnc3Ryb2tlJywgJyNjY2MnKTtcbiAgICB9XG4gIH0sXG5cbiAgc2F2ZVRleHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAvLyBHZXQgc2Vjb25kcyBzdWJqZWN0IHdvcmtlZCBmb3IgcmV2aXNpb25cbiAgICAgIHZhciByZXZpc2lvbkVsYXBzZWQgPSAobmV3IERhdGUoKSAtIHRoaXMucG9zdFBhZ2VEdXJhdGlvblN0YXJ0KSAvIDEwMDA7XG5cbiAgICAgIC8vIFJlbmRlciBsb2FkaW5nIHJpbmdcbiAgICAgIHRoaXMuJGVsLmZpbmQoJyNlZGl0b3ItZnVsbC1idXR0b24tZGl2JykuaHRtbChcbiAgICAgICAgICBIYW5kbGViYXJzLnRlbXBsYXRlc1snbG9hZGluZy1yaW5nJ10oKSk7XG5cbiAgICAgIC8vIEdldCB0ZXh0XG4gICAgICB2YXIgdGV4dCA9IGFwcC5nZXRQYXJhZ3JhcGhzKHRoaXMuJGVsLmZpbmQoJyNlZGl0b3ItZnVsbC1tZWRpdW0tZWRpdG9yJykpO1xuXG4gICAgICAvLyBTYXZlIHBvc3QgdGV4dCB0byB0ZXh0TW9kZWxcbiAgICAgIHRoaXMudGV4dE1vZGVsLnNldCh7J3Bvc3RfdGV4dCc6IHRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICdwb3N0X3BhZ2VfZHVyYXRpb24nOiByZXZpc2lvbkVsYXBzZWR9KTtcblxuICAgICAgLy8gU2V0IHRleHQgdG8gYW5hbHl6ZXJcbiAgICAgIHRoaXMuYW5hbHl6ZXIuc2V0KHsndGV4dCc6IHRleHR9KTtcblxuICAgICAgLy8gRmV0Y2ggZGF0YVxuICAgICAgdGhpcy5hbmFseXplci5zYXZlKG51bGwsIHtcbiAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICBzZWxmLnNlbmRUb1NlcnZlcigpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1vZGVsLCByZXNwb25zZSkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5yZXNwb25zZVRleHQpO1xuICAgICAgICAgIH1cbiAgICAgIH0pO1xuICB9LFxuXG4gIHNlbmRUb1NlcnZlcjogZnVuY3Rpb24oKSB7XG4gICAgLy8gU2F2ZSBsYXN0IGRhdGFcbiAgICB0aGlzLnRleHRNb2RlbC5zZXQoeydwb3N0X251bV9zZW50ZW5jZXMnOiB0aGlzLmFuYWx5emVyLmdldCgnbnVtU2VudGVuY2VzJyksXG4gICAgICAgICdwb3N0X251bV9jbHVzdGVycyc6IHRoaXMuYW5hbHl6ZXIuZ2V0KCdudW1DbHVzdGVyJyksXG4gICAgICAgICdwb3N0X251bV9jb2hlcmVudF9zZW50ZW5jZXMnOiB0aGlzLmFuYWx5emVyLmdldCgnY29oU2VudGVuY2VzJyksXG4gICAgICAgICdwb3N0X251bV9ub25fY29oZXJlbnRfc2VudGVuY2VzJzogdGhpcy5hbmFseXplci5nZXQoJ2NvaE5vdFNlbnRlbmNlcycpLFxuICAgICAgICAncG9zdF9udW1fY29uY2VwdHMnOiB0aGlzLmFuYWx5emVyLmdldCgnbnVtQ29uY2VwdHMnKSxcbiAgICAgICAgJ3Bvc3RfbG9jYWxfY29oZXNpb24nOiB0aGlzLmFuYWx5emVyLmdldCgnbG9jYWwgY29oZXNpb24nKX0pO1xuXG4gICAgLy8gU2VuZCBkYXRhIHRvIHNlcnZlclxuICAgIHRoaXMudGV4dE1vZGVsLnNhdmUobnVsbCwge1xuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgLy8gUmVsb2FkIHBhZ2VcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZnVuY3Rpb24obW9kZWwsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcblxubmV3IGFwcC5DbWFwVmlldygpO1xuIl0sImZpbGUiOiJjbWFwLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=\n"],"sourceRoot":"/source/"}